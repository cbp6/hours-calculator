<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>EMS Duty Calculator</title>
  <link rel="icon" type="image/x-icon" href="https://cdn.discordapp.com/attachments/1007634990017826866/1429873121153781941/e1RunOl.png?ex=68f7b89d&amp;is=68f6671d&amp;hm=ce9605215696103343ce21579830a33d0f8ac177df5d529b7093c189d6dcecb8&amp;">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>
  <style>
    .bubble {
      position: absolute;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, 
        rgba(255, 255, 255, 0.8) 0%, 
        rgba(255, 0, 150, 0.3) 20%, 
        rgba(0, 255, 255, 0.3) 40%, 
        rgba(255, 255, 0, 0.3) 60%, 
        rgba(150, 0, 255, 0.3) 80%, 
        transparent 100%);
      animation: float 2.5s ease-in-out infinite;
      border: 2px solid rgba(255, 255, 255, 0.2);
      box-shadow: 
        inset 0 0 20px rgba(255, 255, 255, 0.3),
        0 0 30px rgba(168, 85, 247, 0.4);
    }
    
    @keyframes float {
      0%, 100% { transform: translateY(0px) rotate(0deg) scale(1); }
      50% { transform: translateY(-40px) rotate(180deg) scale(1.1); }
    }
    
    .glass {
      background: rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(20px);
      border: 2px solid rgba(255, 255, 255, 0.15);
      box-shadow: 
        0 25px 45px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.2);
    }
    
    .popup {
      transform: scale(0) rotate(180deg);
      transition: all 0.4s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    }
    
    .popup.show {
      transform: scale(1) rotate(0deg);
    }
    
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
                  radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.3) 0%, transparent 50%);
      pointer-events: none;
      z-index: 1;
    }
  </style>
</head>
<body class="min-h-screen flex items-center justify-center relative overflow-hidden" style="background: linear-gradient(135deg, #1e1b4b 0%, #312e81 50%, #4c1d95 100%);">
  
  <!-- Logo -->
  <img src="https://cdn.discordapp.com/attachments/1007634990017826866/1429873121153781941/e1RunOl.png?ex=68f7b89d&amp;is=68f6671d&amp;hm=ce9605215696103343ce21579830a33d0f8ac177df5d529b7093c189d6dcecb8&amp;" alt="EMS Logo" class="absolute top-4 left-4 w-12 h-12 z-20 rounded-lg shadow-lg">
  
  <!-- Admin Access Button -->
  <button onclick="showAdminLogin()" class="absolute top-4 right-4 bg-white/10 text-white px-4 py-2 rounded-lg text-sm hover:bg-white/20 transition-all z-20 backdrop-blur-sm border border-white/20">
    Admin Panel
  </button>
  
  <!-- Animated Bubbles -->
  <div class="bubble w-16 h-16 top-5 left-5" style="animation-delay: 0s;"></div>
  <div class="bubble w-24 h-24 top-1/4 right-16" style="animation-delay: 0.8s;"></div>
  <div class="bubble w-12 h-12 bottom-16 left-1/4" style="animation-delay: 1.6s;"></div>
  <div class="bubble w-20 h-20 bottom-8 right-8" style="animation-delay: 0.4s;"></div>
  <div class="bubble w-8 h-8 top-1/2 left-1/2" style="animation-delay: 1.2s;"></div>
  <div class="bubble w-28 h-28 top-16 right-1/3" style="animation-delay: 2s;"></div>
  <div class="bubble w-14 h-14 top-3/4 left-16" style="animation-delay: 0.6s;"></div>
  <div class="bubble w-18 h-18 top-1/3 left-3/4" style="animation-delay: 1.4s;"></div>
  <div class="bubble w-10 h-10 bottom-1/3 right-1/4" style="animation-delay: 1.8s;"></div>
  <div class="bubble w-22 h-22 top-2/3 right-2/3" style="animation-delay: 0.2s;"></div>
  <div class="bubble w-26 h-26 bottom-1/4 left-1/3" style="animation-delay: 1s;"></div>
  <div class="bubble w-6 h-6 top-1/6 right-1/6" style="animation-delay: 1.7s;"></div>
  
  <div class="glass rounded-3xl p-10 w-full max-w-lg shadow-2xl relative z-10">
    <div class="text-center mb-8">
      <h1 class="text-4xl font-bold mb-3 text-white bg-gradient-to-r from-purple-200 to-pink-200 bg-clip-text text-transparent">EMS Duty Calculator</h1>
      <p class="text-purple-200/80 text-lg">Enter your duty schedule below</p>
    </div>
    
    <div class="relative mb-8">
      <textarea id="inputText" 
        class="w-full p-5 bg-white/5 border-2 border-purple-300/20 rounded-3xl focus:ring-4 focus:ring-purple-300/50 focus:border-purple-300/40 focus:outline-none text-white placeholder-purple-200/60 backdrop-blur-sm resize-none h-36 text-lg shadow-inner"
        placeholder="On Duty : 8:50 AM / 1:24 PM / 5:30 PM
Off Duty : 12:09 PM / 4:41 PM / 7:48 PM"></textarea>
    </div>

    <button onclick="calculateHours()" 
      class="w-full bg-gradient-to-r from-purple-500/60 via-pink-500/60 to-purple-600/60 text-white py-4 rounded-3xl font-bold text-lg hover:from-purple-400/70 hover:via-pink-400/70 hover:to-purple-500/70 transition-all duration-500 shadow-2xl hover:shadow-purple-500/25 transform hover:scale-105 hover:-translate-y-1 backdrop-blur-sm border-2 border-purple-400/20">
      Calculate Hours
    </button>
  </div>
  
  <!-- Popup Modal -->
  <div id="popup" class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 hidden backdrop-blur-md">
    <div class="popup glass rounded-3xl p-10 max-w-sm w-full mx-4 text-center">
      <h2 class="text-3xl font-bold text-white mb-6 bg-gradient-to-r from-purple-200 to-pink-200 bg-clip-text text-transparent">Total Hours</h2>
      <div id="result" class="text-4xl font-bold text-white mb-8 bg-gradient-to-r from-green-300 to-blue-300 bg-clip-text text-transparent"></div>
      <button onclick="closePopup()" class="bg-gradient-to-r from-purple-500/70 via-pink-500/70 to-purple-600/70 text-white px-8 py-3 rounded-2xl font-bold hover:from-purple-400/80 hover:via-pink-400/80 hover:to-purple-500/80 transition-all duration-300 backdrop-blur-sm border-2 border-purple-400/30 transform hover:scale-105">
        Close
      </button>
    </div>
  </div>
  
  <!-- Admin Login Modal -->
  <div id="adminLogin" class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 hidden backdrop-blur-md">
    <div class="glass rounded-3xl p-8 max-w-sm w-full mx-4">
      <h2 class="text-2xl font-bold text-white mb-6 text-center">Admin Access</h2>
      <input type="password" id="adminPassword" placeholder="Enter password" class="w-full p-3 bg-white/10 border border-purple-300/30 rounded-xl text-white placeholder-purple-200/70 mb-4 focus:ring-2 focus:ring-purple-300 focus:outline-none">
      <div class="flex gap-3">
        <button onclick="checkAdminPassword()" class="flex-1 bg-gradient-to-r from-green-500/70 to-green-600/70 text-white py-2 rounded-xl font-semibold hover:from-green-400/80 hover:to-green-500/80 transition-all">
          Login
        </button>
        <button onclick="closeAdminLogin()" class="flex-1 bg-gradient-to-r from-red-500/70 to-red-600/70 text-white py-2 rounded-xl font-semibold hover:from-red-400/80 hover:to-red-500/80 transition-all">
          Cancel
        </button>
      </div>
    </div>
  </div>
  
  <!-- Admin Panel -->
  <div id="adminPanel" class="fixed inset-0 bg-black/80 flex items-center justify-center z-50 hidden backdrop-blur-md">
    <div class="glass rounded-3xl p-8 w-full max-w-4xl mx-4 h-5/6 overflow-hidden">
      <div class="flex justify-between items-center mb-6">
        <h2 class="text-3xl font-bold text-white">EMS Attendance Management</h2>
        <button onclick="closeAdminPanel()" class="bg-red-500/70 text-white px-4 py-2 rounded-xl hover:bg-red-400/80 transition-all">
          Close
        </button>
      </div>
      
      <div class="flex gap-6 h-full">
        <!-- User List -->
        <div class="w-1/3">
          <h3 class="text-xl font-semibold text-white mb-4">Staff Members</h3>
          <div id="userList" class="space-y-2 overflow-y-auto h-full">
            <!-- Users will be populated here -->
          </div>
        </div>
        
        <!-- Attendance Details -->
        <div class="w-2/3">
          <div class="mb-4">
            <button onclick="showBulkImport()" class="bg-blue-500/70 text-white px-4 py-2 rounded-xl hover:bg-blue-400/80 transition-all mr-3">
              Import Attendance Data
            </button>
          </div>
          <div id="attendanceView" class="text-white">
            <h3 class="text-xl font-semibold mb-4">Select a staff member to view attendance</h3>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Add User Modal -->
  <div id="addUserModal" class="fixed inset-0 bg-black/80 flex items-center justify-center z-60 hidden backdrop-blur-md">
    <div class="glass rounded-3xl p-8 max-w-sm w-full mx-4">
      <h2 class="text-2xl font-bold text-white mb-6 text-center">Add Staff Member</h2>
      <input type="text" id="newUserName" placeholder="Staff member name" class="w-full p-3 bg-white/10 border border-purple-300/30 rounded-xl text-white placeholder-purple-200/70 mb-4 focus:ring-2 focus:ring-purple-300 focus:outline-none">
      <div class="flex gap-3">
        <button onclick="addUser()" class="flex-1 bg-gradient-to-r from-green-500/70 to-green-600/70 text-white py-2 rounded-xl font-semibold hover:from-green-400/80 hover:to-green-500/80 transition-all">
          Add
        </button>
        <button onclick="closeAddUser()" class="flex-1 bg-gradient-to-r from-red-500/70 to-red-600/70 text-white py-2 rounded-xl font-semibold hover:from-red-400/80 hover:to-red-500/80 transition-all">
          Cancel
        </button>
      </div>
    </div>
  </div>
  
  <!-- Bulk Import Modal -->
  <div id="bulkImportModal" class="fixed inset-0 bg-black/80 flex items-center justify-center z-60 hidden backdrop-blur-md">
    <div class="glass rounded-3xl p-8 max-w-2xl w-full mx-4">
      <h2 class="text-2xl font-bold text-white mb-6 text-center">Import Attendance Data</h2>
      <textarea id="bulkAttendanceData" placeholder="Paste attendance data here..." class="w-full h-64 p-4 bg-white/10 border border-purple-300/30 rounded-xl text-white placeholder-purple-200/70 mb-4 focus:ring-2 focus:ring-purple-300 focus:outline-none resize-none"></textarea>
      <div class="flex gap-3">
        <button onclick="processBulkImport()" class="flex-1 bg-gradient-to-r from-green-500/70 to-green-600/70 text-white py-2 rounded-xl font-semibold hover:from-green-400/80 hover:to-green-500/80 transition-all">
          Import
        </button>
        <button onclick="closeBulkImport()" class="flex-1 bg-gradient-to-r from-red-500/70 to-red-600/70 text-white py-2 rounded-xl font-semibold hover:from-red-400/80 hover:to-red-500/80 transition-all">
          Cancel
        </button>
      </div>
    </div>
  </div>

  <script>
    function parseTime(timeStr) {
      // Normalize input: add space before AM/PM if missing
      const clean = timeStr.trim().replace(/(AM|PM)$/i, " $1");
      return new Date("1970/01/01 " + clean);
    }

    function calculateHours() {
      const text = document.getElementById("inputText").value;

      const onMatch = text.match(/On Duty\s*:\s*([^\n]+)/i);
      const offMatch = text.match(/Off Duty\s*:\s*([^\n]+)/i);

      if (!onMatch || !offMatch) {
        showPopup("❌ Could not find On Duty / Off Duty times.");
        return;
      }

      const onDuty = onMatch[1].split("/");
      const offDuty = offMatch[1].split("/");

      if (onDuty.length !== offDuty.length) {
        showPopup("❌ Mismatched number of On Duty and Off Duty times.");
        return;
      }

      let totalMinutes = 0;

      for (let i = 0; i < onDuty.length; i++) {
        const start = parseTime(onDuty[i]);
        const end = parseTime(offDuty[i]);

        if (isNaN(start.getTime()) || isNaN(end.getTime())) {
          showPopup("❌ Invalid time format detected.");
          return;
        }

        let diff = (end - start) / (1000 * 60);

        if (diff < 0) {
          diff += 24 * 60;
        }

        totalMinutes += diff;
      }

      const hours = Math.floor(totalMinutes / 60);
      const minutes = Math.round(totalMinutes % 60);

      showPopup(`${hours} hours ${minutes} minutes`);
    }
    
    function showPopup(message) {
      document.getElementById("result").innerText = message;
      document.getElementById("popup").classList.remove("hidden");
      setTimeout(() => {
        document.querySelector(".popup").classList.add("show");
      }, 10);
    }
    
    function closePopup() {
      document.querySelector(".popup").classList.remove("show");
      setTimeout(() => {
        document.getElementById("popup").classList.add("hidden");
      }, 300);
    }
    
    // Admin Panel Functions
    const ADMIN_PASSWORD = "ems2024";
    let attendanceData = {};
    
    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyBT2JzMVL1ilCBSlKBUZaWoHw-Pw5-x_fI",
      authDomain: "ems-attendance-aeabd.firebaseapp.com",
      databaseURL: "https://ems-attendance-aeabd-default-rtdb.firebaseio.com",
      projectId: "ems-attendance-aeabd",
      storageBucket: "ems-attendance-aeabd.firebasestorage.app",
      messagingSenderId: "499394628883",
      appId: "1:499394628883:web:3483f98e13a924e535dee6",
      measurementId: "G-LZVHBTGWE2"
    };
    
    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();
    
    // Load shared attendance data from Firebase
    async function loadAttendanceData() {
      try {
        const snapshot = await database.ref('attendance').once('value');
        attendanceData = snapshot.val() || {};
      } catch (error) {
        console.error('Error loading data:', error);
        attendanceData = {};
      }
    }
    
    function showAdminLogin() {
      document.getElementById("adminLogin").classList.remove("hidden");
    }
    
    function closeAdminLogin() {
      document.getElementById("adminLogin").classList.add("hidden");
      document.getElementById("adminPassword").value = "";
    }
    
    async function checkAdminPassword() {
      const password = document.getElementById("adminPassword").value;
      if (password === ADMIN_PASSWORD) {
        closeAdminLogin();
        showAdminPanel();
      } else {
        alert("Incorrect password!");
      }
    }
    
    async function showAdminPanel() {
      document.getElementById("adminPanel").classList.remove("hidden");
      await loadAttendanceData();
      loadUserList();
    }
    
    function closeAdminPanel() {
      document.getElementById("adminPanel").classList.add("hidden");
    }
    
    function loadUserList() {
      const userList = document.getElementById("userList");
      userList.innerHTML = "";
      
      Object.keys(attendanceData).forEach(username => {
        const userDiv = document.createElement("div");
        userDiv.className = "bg-white/10 p-3 rounded-xl hover:bg-white/20 transition-all";
        userDiv.innerHTML = `
          <div class="flex justify-between items-center">
            <div class="cursor-pointer flex-1" onclick="showUserAttendance('${username}')">
              <div class="text-white font-semibold">${username}</div>
              <div class="text-purple-200 text-sm">${Object.keys(attendanceData[username]).length} weeks recorded</div>
            </div>
            <button onclick="removeStaff('${username}')" class="bg-red-500/70 text-white px-2 py-1 rounded text-xs hover:bg-red-400/80 transition-all ml-2">
              Remove
            </button>
          </div>
        `;
        userList.appendChild(userDiv);
      });
    }
    
    function showAddUser() {
      document.getElementById("addUserModal").classList.remove("hidden");
    }
    
    function closeAddUser() {
      document.getElementById("addUserModal").classList.add("hidden");
      document.getElementById("newUserName").value = "";
    }
    
    function addUser() {
      const username = document.getElementById("newUserName").value.trim();
      if (username && !attendanceData[username]) {
        attendanceData[username] = {};
        saveAttendanceData();
        loadUserList();
        closeAddUser();
      } else {
        alert("Please enter a valid name or user already exists!");
      }
    }
    
    function showUserAttendance(username) {
      const attendanceView = document.getElementById("attendanceView");
      const userData = attendanceData[username] || {};
      
      let html = `
        <div class="flex justify-between items-center mb-6">
          <h3 class="text-2xl font-semibold">${username} - Attendance Records</h3>
          <button onclick="addAttendanceWeek('${username}')" class="bg-green-500/70 text-white px-4 py-2 rounded-xl hover:bg-green-400/80 transition-all">
            Add Week
          </button>
        </div>
        <div class="space-y-4 overflow-y-auto h-4/5">
      `;
      
      if (Object.keys(userData).length === 0) {
        html += '<div class="text-purple-200">No attendance records found. Click "Add Week" to start tracking.</div>';
      } else {
        Object.keys(userData).sort().reverse().forEach(week => {
          const weekData = userData[week];
          html += `
            <div class="bg-white/10 p-4 rounded-xl">
              <div class="flex justify-between items-center mb-3">
                <h4 class="font-semibold text-lg">${week}</h4>
                <div class="text-sm text-purple-200">${weekData.totalHours || 0} total hours</div>
              </div>
              <div class="grid grid-cols-7 gap-2 text-sm">
                ${['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'].map(day => `
                  <div class="text-center">
                    <div class="font-medium text-purple-200">${day}</div>
                    <div class="mt-1 p-2 bg-white/5 rounded text-xs cursor-pointer hover:bg-white/10 transition-all" onclick="editDayHours('${username}', '${week}', '${day}')">
                      ${weekData.days && weekData.days[day] ? weekData.days[day] + 'h' : '-'}
                    </div>
                  </div>
                `).join('')}
              </div>
            </div>
          `;
        });
      }
      
      html += '</div>';
      attendanceView.innerHTML = html;
    }
    
    function addAttendanceWeek(username) {
      const weekStart = prompt("Enter week start date (e.g., Oct 17-23, 2024):");
      if (weekStart) {
        const hours = {};
        ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday'].forEach(day => {
          const dayHours = prompt(`Enter hours for ${day} (or 0 if no work):`);
          if (dayHours !== null) {
            hours[day.substring(0, 3)] = parseInt(dayHours) || 0;
          }
        });
        
        const totalHours = Object.values(hours).reduce((sum, h) => sum + h, 0);
        
        if (!attendanceData[username]) attendanceData[username] = {};
        attendanceData[username][weekStart] = {
          days: hours,
          totalHours: totalHours
        };
        
        saveAttendanceData();
        showUserAttendance(username);
        loadUserList();
      }
    }
    
    function removeStaff(username) {
      if (confirm(`Are you sure you want to remove ${username} and all their attendance records?`)) {
        delete attendanceData[username];
        saveAttendanceData();
        loadUserList();
        document.getElementById("attendanceView").innerHTML = '<h3 class="text-xl font-semibold mb-4">Select a staff member to view attendance</h3>';
      }
    }
    
    async function saveAttendanceData() {
      try {
        await database.ref('attendance').set(attendanceData);
        console.log('Data saved successfully to Firebase');
      } catch (error) {
        console.error('Error saving data:', error);
        localStorage.setItem('emsAttendance', JSON.stringify(attendanceData));
        alert('Saved locally. Firebase sync failed: ' + error.message);
      }
    }
    
    function editDayHours(username, week, day) {
      const currentHours = attendanceData[username][week].days[day] || 0;
      const newHours = prompt(`Edit hours for ${day} (current: ${currentHours}h)\nEnter 0 to remove, or new hours:`, currentHours);
      
      if (newHours !== null) {
        const hours = parseFloat(newHours) || 0;
        
        if (hours === 0) {
          delete attendanceData[username][week].days[day];
        } else {
          attendanceData[username][week].days[day] = hours;
        }
        
        // Recalculate total hours for the week
        const weekData = attendanceData[username][week];
        weekData.totalHours = Object.values(weekData.days).reduce((sum, h) => sum + (h || 0), 0);
        
        saveAttendanceData();
        showUserAttendance(username);
        loadUserList();
      }
    }
    
    function showBulkImport() {
      document.getElementById("bulkImportModal").classList.remove("hidden");
    }
    
    function closeBulkImport() {
      document.getElementById("bulkImportModal").classList.add("hidden");
      document.getElementById("bulkAttendanceData").value = "";
    }
    
    async function processBulkImport() {
      const data = document.getElementById("bulkAttendanceData").value;
      const entries = parseAttendanceData(data);
      
      if (entries.length === 0) {
        alert("No valid attendance data found!");
        return;
      }
      
      entries.forEach(entry => {
        if (!attendanceData[entry.name]) {
          attendanceData[entry.name] = {};
        }
        
        const weekKey = getWeekKey(entry.date);
        if (!attendanceData[entry.name][weekKey]) {
          attendanceData[entry.name][weekKey] = { days: {}, totalHours: 0 };
        }
        
        const dayName = getDayName(entry.date);
        attendanceData[entry.name][weekKey].days[dayName] = entry.hours;
        
        // Recalculate total hours for the week
        const weekData = attendanceData[entry.name][weekKey];
        weekData.totalHours = Object.values(weekData.days).reduce((sum, h) => sum + (h || 0), 0);
      });
      
      // Save data after processing
      try {
        await saveAttendanceData();
        loadUserList();
        closeBulkImport();
        alert(`Successfully imported ${entries.length} attendance records!`);
      } catch (error) {
        alert(`Imported ${entries.length} records but failed to save to GitHub: ${error.message}`);
      }
    }
    
    function parseAttendanceData(data) {
      const entries = [];
      const blocks = data.split(/(?=\w+\s+[^\n]*—)/);
      
      blocks.forEach(block => {
        const lines = block.trim().split('\n');
        let entry = {};
        
        lines.forEach(line => {
          line = line.trim();
          
          if (line.includes('Name') && line.includes('@')) {
            const nameMatch = line.match(/@([^@\n]+?)(?=\s*$)/);
            if (nameMatch) {
              entry.name = nameMatch[1].trim();
            }
          }
          
          if (line.includes('Total Hours')) {
            const hoursMatch = line.match(/(\d+)\s*(?:HOURS?|hours?)(?:\s*(\d+)\s*(?:MINUTES?|minutes?|mins?|MIN)?)?/i);
            if (hoursMatch) {
              const hours = parseInt(hoursMatch[1]) || 0;
              const minutes = parseInt(hoursMatch[2]) || 0;
              entry.hours = Math.round((hours + (minutes / 60)) * 100) / 100;
            }
          }
          
          if (line.includes('Date')) {
            const dateMatch = line.match(/(\d{1,2})\/(\d{1,2})\/(\d{4})/);
            if (dateMatch) {
              entry.date = `${dateMatch[3]}-${dateMatch[2].padStart(2, '0')}-${dateMatch[1].padStart(2, '0')}`;
            }
          }
        });
        
        if (entry.name && entry.hours !== undefined && entry.date) {
          entries.push(entry);
        }
      });
      
      return entries;
    }
    
    function getWeekKey(dateStr) {
      const date = new Date(dateStr);
      const oct17_2025 = new Date('2025-10-17');
      
      const daysDiff = Math.floor((date - oct17_2025) / (1000 * 60 * 60 * 24));
      const weekNumber = Math.floor(daysDiff / 7);
      
      const weekStart = new Date(oct17_2025);
      weekStart.setDate(oct17_2025.getDate() + (weekNumber * 7));
      
      const weekEnd = new Date(weekStart);
      weekEnd.setDate(weekStart.getDate() + 6);
      
      const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
      return `${monthNames[weekStart.getMonth()]} ${weekStart.getDate()}-${weekEnd.getDate()}, ${weekStart.getFullYear()}`;
    }
    
    function getDayName(dateStr) {
      const date = new Date(dateStr);
      const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
      return days[date.getDay()];
    }
    
    // Allow Enter key for password
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Enter') {
        if (!document.getElementById('adminLogin').classList.contains('hidden')) {
          checkAdminPassword();
        }
      }
    });
  </script>
</body>
</html>
